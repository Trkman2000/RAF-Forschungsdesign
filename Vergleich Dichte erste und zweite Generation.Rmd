###Vergleich Dichte Netzwerke erste und zweite Generation
##Dichte des Netzwerks der ersten Generation
#Erstellung Netzwerk erste Generation
```{r delete_vertices, exercise=TRUE, exercise.lines = 15}
library(igraph)
el <- read.csv("https://raw.githubusercontent.com/ca048/RAF-Forschungsdesign/master/edges.csv", header=T, as.is=T, sep = ",")
nodes <- read.csv("https://raw.githubusercontent.com/ca048/RAF-Forschungsdesign/master/nodes.csv", header=T, as.is=T, sep = ",")
edgematrix <-as.matrix(el)
raf <- graph_from_data_frame(d=edgematrix, vertices=nodes, directed=T)

raf_eins <- delete_vertices(raf, V(raf)[generation > "1"]) 
plot(raf_eins, layout=layout_with_kk,
     main="Netzwerk 1. Generation",
     edge.color="green",
     edge.arrow.size=.5,
     vertex.color="pink")
```
#Löschen der Aktionen
```{r delete_vertices, exercise=TRUE, exercise.lines = 15}
raf_eins_final <- delete.vertices(raf_eins, V(raf_eins)[type > "1"])
raf_eins_final
plot(raf_eins_final, layout=layout_with_kk,
     main="Netzwerk 1. Generation ohne Aktionen",
     edge.color="green",
     edge.arrow.size=.5,
     vertex.color="pink")
```
#Berechnung Dichte Netzwerk erste Generation
```{r density, exercise=TRUE, exercise.lines = 15}
edge_density(raf_eins_final)

```
#Die Dichte des Netzwerks der ersten Generation beträgt also 0.1409091, das bedeutet, dass ca. 14% von allen möglichen Beziehungen zwischen den Knoten realisiert wurde. Dies bedeutet auch, dass zwischen ca. 95% der Knoten keine Beziehungen bestehen. Im Vergleich zur Dichte des Gesamtnetzwerks ist die Dichte der ersten Generation damit erheblich größer.


##Dichte des Netzwerks der zweiten Generation
#Erstellung Netzwerk zweite Generation
```{r delete_vertices, exercise=TRUE, exercise.lines = 15}
library(igraph)
el <- read.csv("https://raw.githubusercontent.com/ca048/RAF-Forschungsdesign/master/edges.csv", header=T, as.is=T, sep = ",")
nodes <- read.csv("https://raw.githubusercontent.com/ca048/RAF-Forschungsdesign/master/nodes.csv", header=T, as.is=T, sep = ",")
edgematrix <-as.matrix(el)
raf <- graph_from_data_frame(d=edgematrix, vertices=nodes, directed=T)

raf_zwei <- delete_vertices(raf, V(raf)[generation <"2"]) 
#löschen der 1. Generation
raf_zwei
plot(raf_zwei, layout=layout_with_kk,
     main="Netzwerk 2. Generation",
     edge.color="green",
     edge.arrow.size=.5,
     vertex.color="pink")
```
#Löschen derer, für die generation > 2 gilt
```{r delete_vertices, exercise=TRUE, exercise.lines = 15}
raf_zwei_fast_final <- delete.vertices(raf_zwei, V(raf_zwei)[generation > "2"])
raf_zwei_fast_final
plot(raf_zwei_fast_final, layout=layout_with_kk,
     main="Netzwerk 2. Generation fast final",
     edge.color="green",
     edge.arrow.size=.5,
     vertex.color="pink")
```
#Löschen der Aktionen
```{r delete_vertices, exercise=TRUE, exercise.lines = 15}
raf_zwei_final <- delete.vertices(raf_zwei_fast_final, V(raf_zwei_fast_final)[type > "1"])
raf_zwei_final
plot(raf_zwei_final, layout=layout_with_kk,
     main="Netzwerk 2. Generation final",
     edge.color="green",
     edge.arrow.size=.5,
     vertex.color="pink")
```
#Berechnung Dichte Netzwerk erste Generation
```{r density, exercise=TRUE, exercise.lines = 15}
edge_density(raf_zwei_final)

```
#Die Dichte des Netzwerks der zweiten Generation beträgt also 0.1532977, das bedeutet, dass ca. 15% von allen möglichen Beziehungen zwischen den Knoten realisiert wurde. Dies bedeutet auch, dass zwischen ca. 95% der Knoten keine Beziehungen bestehen. Im Vergleich zur Dichte des Gesamtnetzwerks ist die Dichte der zweiten Generation damit erheblich größer. Im Vergleich zur Dichte des Netzwerks der ersten Generation ist sie nur etwa 1% größer.